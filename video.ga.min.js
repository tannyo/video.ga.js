/*!
 * video.ga.js | v0.1
 * derived from:
 * vimeo.ga.js | v0.2
 * Copyright (c) 2012 - 2013 Sander Heilbron (http://sanderheilbron.nl)
 * MIT licensed
 * Added Support for Detecting ga.js or analytics.js to use proper tracking code for each - 11/6/2013 - Robert Waddell (http://mrrobwad.blogspot.com)
 *
 * 2014-08-28 TKO Changed to be called passing the iframe so that it can be called for dynamically created iframes.
 *                Removed jQuery ready event.
 *                Added strict.
 *                Ran through jslint.com and corrected errors.
 * 2014-09-02 TKO Provided for future YouTube support. Turned into object. Added config object. Removed reliance on data-seek and data-progress attributes.
 * 2014-09-03 TKO Updated to v0.4 support.
 */
;var videoTrack=(function(){var g,a,e,i,b,c=false;function f(l){if(c){console.log(i,l)}_gaq.push(["_trackEvent",i,l,b,undefined,true])}function j(l){if(c){console.log(i,l)}ga("send","event",i,l,b)}function k(l){if(c){console.log(i,l)}dataLayer.push({event:"Vimeo",eventCategory:i,eventAction:l,eventLabel:b,eventValue:undefined,eventNonInteraction:true})}a=(function(){var C,z,o,t,l,p,q,B,w,y,s;function x(F,E){var D={method:F};if(E){D.value=E}z.contentWindow.postMessage(JSON.stringify(D),b)}function u(E){p=Math.round((E.percent)*100);if(!C.progress){return}var D;if(p>24&&!o){D="Played video: 25%";o=true}if(p>49&&!t){D="Played video: 50%";t=true}if(p>74&&!l){D="Played video: 75%";l=true}if(D){g(D)}}function A(){if(p<99&&!w){g("Paused video");w=true}}function m(){x("addEventListener","play");x("addEventListener","seek");x("addEventListener","pause");x("addEventListener","finish");x("addEventListener","playProgress");p=0;o=false;t=false;l=false;B=false;w=false;y=false;s=false;q=false}function r(E){if(!/vimeo.com/i.test(E.origin)){return}var D=JSON.parse(E.data);if(c){console.log(D.event)}switch(D.event){case"ready":m();break;case"playProgress":u(D.data);break;case"seek":if(C.seek&&!s){g("Skipped video forward or backward");s=true}break;case"play":if(!B){g("Started video");B=true}else{if(!y&&w){g("Resumed video");y=true}}break;case"pause":A();break;case"finish":if(!q){g("Completed video");q=true}break}}function n(E,D){C={progress:false,seek:false};if(c){console.log("tracking Vimeo video")}i="Vimeo";z=E;b=z.src.split("?")[0];if(!/^http/.test(b)){b=location.protocol+b}if(D){C.progress=C.progress||D.progress;C.seek=C.seek||D.seek}if(c){console.log("config",JSON.stringify(C))}if(window.addEventListener){window.addEventListener("message",r,false)}else{window.attachEvent("onmessage",r,false)}}function v(){if(window.addEventListener){window.removeEventListener("message",r,false)}else{window.detachEvent("message",r,false)}if(c){console.log("Vimeo message handler removed")}if(!q){g("Closed video at "+p+"%")}}return{start:n,stop:v}}());function d(m,l){i="";if(typeof ga==="function"){g=j}else{if(_gaq&&typeof _gaq.push==="function"){g=f}else{if(dataLayer&&typeof dataLayer.push==="function"){g=k}else{console.log("Unable track video events because Google analytics is not available.");return}}}if(m){if(m.jquery){m=m[0]}}else{console.log("No iframe to track video events.");return}if(m.src&&/vimeo.com/i.test(m.src)){a.start(m,l)}}function h(){if(i==="Vimeo"){a.stop()}}return{start:d,stop:h}}());
